{{#head 'editor'}}

  <!-- Styling for Editor page -->
  <link rel=stylesheet href={{baseURL}}/css/editor.css>

{{/head}}

<main id={{id}}>

  <select id=dropdown>

    <option value=placeholder disabled selected>CV Type</option>

    {{#each types}}
      <option value='{{@key}}'>{{@key}}</option>
    {{/each}}

  </select>

  <h1 class=page-title>{{Type}}</h1>

  <nav id=list>

    <button
      form=form
      formaction='/admin/{{coll}}'
      name=addItem
      type=submit
      value=true>
      Add Item
    </button>

    <ol>
      {{#each docs}}
        <li>
          <a href='/admin/{{../coll}}/{{cvid}}'>
            {{#if title}}
              {{title}}
            {{else if name}}
              {{name}}
            {{else if organization}}
              {{organization}}
            {{else if location}}
              {{location}} ({{languages}})
            {{/if}}
          </a>
        </li>
      {{/each}}
    </ol>

  </nav>

  <form id=form method=post action=/admin/{{coll}}/{{doc.cvid}}>

    {{!-- CSRF token --}}
    <input id=csrf type=hidden name=_csrf value='{{csrf}}'>

    {{#if doc}}
      {{#with doc}}


      {{!-- Document ID --}}
      <input id=id type=hidden name=id value='{{id}}'>


      {{#isType "language"}}

        {{!-- Autonym --}}
        <label for=autonym>

          <b>Autonym</b>

          <input
            inputmode=full-width-latin
            name=autonym
            placeholder=autonym
            required
            type=text
            value='{{autonym}}'>

        </label>

        {{!-- Competency --}}
        <label for=competency>

          <b>Competency</b>

          <select name=competency>
            {{#each comp}}
              <option value='{{@key}}' {{#if this}}selected{{/if}}>{{@key}}</option>
            {{/each}}
          </select>

        </label>

      {{/isType}}


      {{!-- Author --}}
      {{#isType "media"}}
        <label for=author>

          <b>Author</b>

          <input
            inputmode=latin-name
            name=author
            placeholder=Author
            required
            type=text
            value='{{author}}'>

        </label>
      {{/isType}}


      {{!-- Abbreviation --}}
      {{#isType "membership, service"}}
        <label for=abbreviation>

          <b>Abbreviation</b>

          <input
            inputmode=verbatim
            name=abbreviation
            placeholder=ABBR
            type=text
            value='{{abbreviation}}'>

        </label>
      {{/isType}}


      {{!-- Date & Forthcoming --}}
      {{#isType "media, publication"}}
        <fieldset>

          <legend>Date</legend>

          <input
            id=date
            name=date
            type=date
            value='{{date}}'
            {{#if forthcoming}}disabled{{else}}required{{/if}}>

          {{#isType "publication"}}
            <label for=forthcoming>
              <b>Forthcoming</b>
              <input id=forthcoming type=checkbox name=forthcoming {{#if forthcoming}}checked{{/if}}>
            </label>
          {{/isType}}


        </fieldset>
      {{/isType}}


      {{!-- End Year --}}
      {{#isType "education, fieldwork, service, work"}}
        <fieldset>

          <legend>End Year</legend>

          <input
            id=endYear
            name=endYear
            placeholder=YYYY
            type=text
            value='{{endYear}}'
            {{#if ongoing}}disabled{{else}}required{{/if}}>

          <label for=ongoing>
            <b>Ongoing</b>
            <input id=ongoing type=checkbox name=ongoing {{#if ongoing}}checked{{/if}}>
          </label>

        </fieldset>
      {{/isType}}


      {{!-- Categories --}}
      {{#isType "award, fieldwork, language, media, membership, proficiency, publication, service, work"}}
        <fieldset class=categories>

          <legend>Categories</legend>

          {{#each cats}}
            <label>
              <input type=checkbox name=categories value='{{@key}}' {{#if this}}checked{{/if}}>
              <i>{{@key}}</i>
            </label>
          {{/each}}

        </fieldset>
      {{/isType}}


      {{!-- Description --}}
      {{#isType "award, category, course, fieldwork, publication"}}
        <label for=description>

          <b>Description</b>

          <textarea
            inputmode=latin-prose
            name=description
            placeholder='A description of this item, in Markdown'
            row=8>{{description}}</textarea>

        </label>
      {{/isType}}


      {{!-- Achievements --}}
      {{#isType "education, work"}}

        {{#*inline "achievement"}}
          <li>

            <input
              inputmode=latin-prose
              name=achievements
              placeholder='Brief description of this achievement'
              type=text
              value='{{this}}'>

            <button type=button name=deleteAchievement class=trash>
              {{{../../icons.delete}}}
            </button>

          </li>
        {{/inline}}

        <fieldset class=achievements>

          <legend>Achievements</legend>

          <ul>
            {{#each achievements}}
              {{> achievement this}}
            {{/each}}
          </ul>

          <button id=addAchievement type=button name=addAchievement>Add Achievement</button>

          <template id=achievement-template>
            {{> achievement ""}}
          </template>

        </fieldset>

      {{/isType}}
      {{!-- End achievements --}}


      {{!-- References (Name, Email, Phone) --}}
      {{#isType "reference"}}

        {{!-- Name --}}

        {{!-- Email --}}
        <label for=email>

          <b>Email</b>

          <input
            inputmode=email
            name=email
            placeholder=Email
            required
            type=email
            value='{{email}}'>

        </label>

        {{!-- Phone --}}

      {{/isType}}


      {{!-- Buttons --}}
      <div class=buttons>

        {{!-- Save button --}}
        <button id=saveButton type=submit name=saveItem value=true>Save</button>

        {{!-- Delete button --}}
        <button id=delete type=submit name=deleteItem value=true>Delete</button>

      </div>
      {{!-- End buttons --}}


      {{/with}}
    {{/if}}

  </form>

</main>

{{#section 'script'}}

  <!-- Script for Editor page -->
  <script src=/js/editor.js type=module defer></script>

{{/section}}
